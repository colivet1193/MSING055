-------------Population vs. Tube stations by borough
SELECT POPULATION_DISTRIB.BOROUGH_NAME, 
		ROUND(SUM(POPULATION_DISTRIB.POPULATION)/SUM(POPULATION_DISTRIB.SQUARE_KM),0) AS POPULATION_BY_KM2,
		COUNT(MASTER_STATION.STATION_CODE) AS NUMBER_STATIONS		
	FROM POPULATION_DISTRIB
		INNER JOIN MASTER_STATION
			ON POPULATION_DISTRIB.BOROUGH_CODE=MASTER_STATION.BOROUGH_CODE
		GROUP BY POPULATION_DISTRIB.BOROUGH_NAME;

------------Passengers vs population by borough

SELECT POPULATION_DISTRIB.BOROUGH_NAME,
		POPULATION_DISTRIB.BOROUGH_CODE,
		ROUND(SUM(POPULATION_DISTRIB.POPULATION)/SUM(POPULATION_DISTRIB.SQUARE_KM),0) AS POPULATION_BY_KM2,
		SUM(MASTER_STATION.PASSENGERS_YEAR) AS TOTAL_PASSANGERS_YEAR
	FROM MASTER_STATION
		INNER JOIN POPULATION_DISTRIB
		GROUP BY BOROUGH_NAME, BOROUGH_CODE; 
		
		
---------------Disturbances vs passengers by station
SELECT MASTER_STATION.STATION_NAME, 
		ROUND((MASTER_STATION.PASSENGERS_YEAR*1000000/12),0) AS PASSANGERS_MONTH,
		ROUND((SUM(TWEET_DETAIL.IS_DELAY)/2),0) AS DISTURBANCES_MONTH, 
		ROUND((MASTER_STATION.PASSENGERS_YEAR*1000000/12)/ROUND((SUM(TWEET_DETAIL.IS_DELAY)/2),0),0) AS PASSANGERS_VS_DELAY 
	FROM MASTER_STATION
		INNER JOIN MASTER_LINE
			ON MASTER_STATION.LINE_CODE=MASTER_LINE_
		INNER JOIN TWEET_DETAIL
			ON MASTER_LINE_TWEETER_NAME=TWEET_DETAIL.TWEETER_NAME
	GROUP BY MASTER_STATION.STATION_NAME